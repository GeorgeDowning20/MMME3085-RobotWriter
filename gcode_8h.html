<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CW 1: RobotWriter/robot/gcode.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CW 1
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_482e22fbedfde076dfaae0f676724d96.html">RobotWriter</a></li><li class="navelem"><a class="el" href="dir_21265d1b44195e33d179714a01819aa6.html">robot</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">gcode.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Declarations for text processing functions that utilize font data and robot movement.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="robot_8h_source.html">robot.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fontData_8h_source.html">../font/fontData.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="error_8h_source.html">../misc/error.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for gcode.h:</div>
<div class="dyncontent">
<div class="center"><img src="gcode_8h__incl.png" border="0" usemap="#aRobotWriter_2robot_2gcode_8h" alt=""/></div>
<map name="aRobotWriter_2robot_2gcode_8h" id="aRobotWriter_2robot_2gcode_8h">
<area shape="rect" title="Declarations for text processing functions that utilize font data and robot movement." alt="" coords="28,5,221,32"/>
<area shape="rect" href="robot_8h.html" title="Declarations for robot control functions and related constants." alt="" coords="323,80,391,107"/>
<area shape="rect" href="error_8h.html" title="Defines error codes and a function to handle and log these errors." alt="" coords="99,304,209,331"/>
<area shape="rect" href="fontData_8h.html" title="Declarations for managing font data, including a hash table for storing font characters." alt="" coords="58,80,191,107"/>
<area shape="rect" href="rs232_8h.html" title=" " alt="" coords="605,155,708,181"/>
<area shape="rect" href="serial_8h.html" title=" " alt="" coords="453,155,556,181"/>
<area shape="rect" href="fontChar_8h.html" title="Declarations and definitions related to the fontCharacter_t structure and its operations." alt="" coords="129,155,259,181"/>
<area shape="rect" href="cursor_8h.html" title="Declaration of the cursor_t structure and associated functions." alt="" coords="345,229,467,256"/>
<area shape="rect" title=" " alt="" coords="471,379,538,405"/>
<area shape="rect" title=" " alt="" coords="543,229,613,256"/>
<area shape="rect" title=" " alt="" coords="638,229,729,256"/>
<area shape="rect" href="coord_8h.html" title="Defines the Coord2D_t structure for representing 2D coordinates and provides inline functions for bas..." alt="" coords="234,304,351,331"/>
<area shape="rect" title=" " alt="" coords="148,229,219,256"/>
<area shape="rect" title=" " alt="" coords="53,229,124,256"/>
<area shape="rect" title=" " alt="" coords="375,304,458,331"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="gcode_8h__dep__incl.png" border="0" usemap="#aRobotWriter_2robot_2gcode_8hdep" alt=""/></div>
<map name="aRobotWriter_2robot_2gcode_8hdep" id="aRobotWriter_2robot_2gcode_8hdep">
<area shape="rect" title="Declarations for text processing functions that utilize font data and robot movement." alt="" coords="81,5,274,32"/>
<area shape="rect" href="main_8h.html" title="Main configuration header for setting up the robot and font data environment." alt="" coords="5,80,155,107"/>
<area shape="rect" href="gcode_8c.html" title="Implementation of text processing functions that generate G&#45;code from text using font data." alt="" coords="179,80,371,107"/>
<area shape="rect" href="main_8c.html" title="Entry point for the robot text drawing application." alt="" coords="6,155,154,181"/>
</map>
</div>
</div>
<p><a href="gcode_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a44ba85fdeef6e4fb50e27ec96de1f736"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#ac786def90215a74a98b8a97fdb0b329e">errorCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcode_8h.html#a44ba85fdeef6e4fb50e27ec96de1f736">process_text_file</a> (const <a class="el" href="fontData_8h.html#a4d7b4168ad80189b4d00c9b0a8d1d70d">fontData_t</a> *const fontData, FILE *const file)</td></tr>
<tr class="memdesc:a44ba85fdeef6e4fb50e27ec96de1f736"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes a text file using the provided font data.  <a href="gcode_8h.html#a44ba85fdeef6e4fb50e27ec96de1f736">More...</a><br /></td></tr>
<tr class="separator:a44ba85fdeef6e4fb50e27ec96de1f736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad752fe57ef57309b894a1e29b1be17f6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#ac786def90215a74a98b8a97fdb0b329e">errorCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcode_8h.html#ad752fe57ef57309b894a1e29b1be17f6">generate_gcode</a> (const <a class="el" href="fontData_8h.html#a4d7b4168ad80189b4d00c9b0a8d1d70d">fontData_t</a> *const fontData, const char *text)</td></tr>
<tr class="memdesc:ad752fe57ef57309b894a1e29b1be17f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates G-code commands based on the provided text using the given font data.  <a href="gcode_8h.html#ad752fe57ef57309b894a1e29b1be17f6">More...</a><br /></td></tr>
<tr class="separator:ad752fe57ef57309b894a1e29b1be17f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Declarations for text processing functions that utilize font data and robot movement. </p>
<p>This file provides functions to process text from a file and to generate G-code instructions using a given font data set. </p><dl class="section note"><dt>Note</dt><dd>View documentation at <a href="https://georgedowning20.github.io/MMME3085-RobotWriter/">https://georgedowning20.github.io/MMME3085-RobotWriter/</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad752fe57ef57309b894a1e29b1be17f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad752fe57ef57309b894a1e29b1be17f6">&#9670;&nbsp;</a></span>generate_gcode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#ac786def90215a74a98b8a97fdb0b329e">errorCode_t</a> generate_gcode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="fontData_8h.html#a4d7b4168ad80189b4d00c9b0a8d1d70d">fontData_t</a> *const&#160;</td>
          <td class="paramname"><em>fontData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates G-code commands based on the provided text using the given font data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fontData</td><td>Pointer to the fontData_t structure containing font information. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">text</td><td>Pointer to the text string for which G-code will be generated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS on successful G-code generation, or an appropriate error code if generation fails.</dd></dl>
<p>This function uses a static cursor to track the current drawing position. If the cursor isn't initialized, it constructs a new cursor using the font data's scale factor. Before processing the text, it checks if the word would overflow the current cursor line. If so, it moves to a new line.</p>
<p>It then iterates through the text:</p><ul>
<li>Spaces cause a cursor update.</li>
<li>Newline ('<br  />
') and carriage return ('\r') characters cause the cursor to adjust its position accordingly.</li>
<li>Other characters are looked up in the font data. If found, their strokes are sent to the robot using <code><a class="el" href="robot_8c.html#aad90fa0e55a1c01b398f24b6b5285e8d" title="Sends a stroke command to the robot based on the current cursor position.">SendStoke()</a></code>. After drawing each character, the cursor is updated. </li>
</ul>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gcode_8h_ad752fe57ef57309b894a1e29b1be17f6_cgraph.png" border="0" usemap="#agcode_8h_ad752fe57ef57309b894a1e29b1be17f6_cgraph" alt=""/></div>
<map name="agcode_8h_ad752fe57ef57309b894a1e29b1be17f6_cgraph" id="agcode_8h_ad752fe57ef57309b894a1e29b1be17f6_cgraph">
<area shape="rect" title="Generates G&#45;code commands based on the provided text using the given font data." alt="" coords="5,162,132,188"/>
<area shape="rect" href="cursor_8c.html#ac9206024f47e097a8c24cd2cdfa7234f" title="Constructs and initializes a new cursor_t object." alt="" coords="180,162,317,188"/>
<area shape="rect" href="error_8h.html#a46ae3737b6b20a442370723dace4b3e6" title="Handles and logs the given error code." alt="" coords="571,162,675,188"/>
<area shape="rect" href="robot_8c.html#aad90fa0e55a1c01b398f24b6b5285e8d" title="Sends a stroke command to the robot based on the current cursor position." alt="" coords="203,339,294,366"/>
<area shape="rect" href="cursor_8c.html#a28f88c371fa702d0ff93c682e2686cf7" title="Moves the cursor to the start of the current line (carriage return)." alt="" coords="377,187,499,214"/>
<area shape="rect" href="cursor_8c.html#abae14e94f199f0a08c0d21080564e52e" title="Moves the cursor by a specified delta." alt="" coords="405,288,471,315"/>
<area shape="rect" href="cursor_8c.html#a512b5b1efe20e69fcbfc7525ba3b2dc0" title="Moves the cursor to a new line." alt="" coords="398,86,478,112"/>
<area shape="rect" href="cursor_8c.html#acbd74b57e2f2b6852d13f61c905d82fc" title="Sets the cursor to a specified position." alt="" coords="413,238,463,264"/>
<area shape="rect" href="cursor_8c.html#a7a85519c0c8c138cb884fdac97049cd0" title="Checks if the given word would overflow the current cursor boundaries." alt="" coords="365,35,511,62"/>
<area shape="rect" href="cursor_8c.html#ae6cd8baec7e9a446d286b99ba00781c4" title="Updates the cursor position after advancing by one character." alt="" coords="401,136,475,163"/>
<area shape="rect" href="cursor_8c.html#afe2261ec63130405e2211af6c13accec" title="Checks if the current cursor position is within defined boundaries." alt="" coords="559,244,687,271"/>
<area shape="rect" href="coord_8h.html#a5bc8e590b6856be3e274cde788d2428a" title="Adds two 2D coordinates." alt="" coords="571,320,674,347"/>
<area shape="rect" href="robot_8c.html#a7491b87f64cad2b3f2e418e256ab78f0" title="Sends a command buffer to the robot and waits for a reply." alt="" coords="374,390,502,416"/>
<area shape="rect" href="serial_8c.html#a81685016bdf8b33327c0effc3946c23f" title=" " alt="" coords="577,383,668,410"/>
<area shape="rect" href="serial_8c.html#a41ebffe26e5aa854de06af059212be92" title=" " alt="" coords="569,434,677,460"/>
<area shape="rect" href="rs232_8c.html#a179396991e5d9e3ef1be67e6f03038a6" title=" " alt="" coords="757,383,863,410"/>
<area shape="rect" href="rs232_8c.html#ad8d4dbe7691e53e178360403228d650b" title=" " alt="" coords="933,383,1065,410"/>
<area shape="rect" href="rs232_8c.html#af66e3a0fc5eb7defb43aa61487a0b895" title=" " alt="" coords="735,434,885,460"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gcode_8h_ad752fe57ef57309b894a1e29b1be17f6_icgraph.png" border="0" usemap="#agcode_8h_ad752fe57ef57309b894a1e29b1be17f6_icgraph" alt=""/></div>
<map name="agcode_8h_ad752fe57ef57309b894a1e29b1be17f6_icgraph" id="agcode_8h_ad752fe57ef57309b894a1e29b1be17f6_icgraph">
<area shape="rect" title="Generates G&#45;code commands based on the provided text using the given font data." alt="" coords="288,5,415,32"/>
<area shape="rect" href="gcode_8c.html#a44ba85fdeef6e4fb50e27ec96de1f736" title="Processes a text file using the provided font data." alt="" coords="108,5,240,32"/>
<area shape="rect" href="main_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a44ba85fdeef6e4fb50e27ec96de1f736"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44ba85fdeef6e4fb50e27ec96de1f736">&#9670;&nbsp;</a></span>process_text_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#ac786def90215a74a98b8a97fdb0b329e">errorCode_t</a> process_text_file </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="fontData_8h.html#a4d7b4168ad80189b4d00c9b0a8d1d70d">fontData_t</a> *const&#160;</td>
          <td class="paramname"><em>fontData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *const&#160;</td>
          <td class="paramname"><em>file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes a text file using the provided font data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fontData</td><td>Pointer to the fontData_t structure containing font information. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">file</td><td>Pointer to the file from which text will be read and processed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS on successful processing, or an appropriate error code if processing fails.</dd></dl>
<p>This function reads the text file character by character and accumulates characters into a buffer. Once it encounters a space, newline, or carriage return, it treats the accumulated characters as a complete "word" and calls <code><a class="el" href="gcode_8c.html#ad752fe57ef57309b894a1e29b1be17f6" title="Generates G-code commands based on the provided text using the given font data.">generate_gcode()</a></code> to generate G-code for that word.</p>
<p>If the file ends and there are still accumulated characters, it processes those as the final word. After processing the file, it closes the file and sends the robot to its home position. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gcode_8h_a44ba85fdeef6e4fb50e27ec96de1f736_cgraph.png" border="0" usemap="#agcode_8h_a44ba85fdeef6e4fb50e27ec96de1f736_cgraph" alt=""/></div>
<map name="agcode_8h_a44ba85fdeef6e4fb50e27ec96de1f736_cgraph" id="agcode_8h_a44ba85fdeef6e4fb50e27ec96de1f736_cgraph">
<area shape="rect" title="Processes a text file using the provided font data." alt="" coords="5,181,137,208"/>
<area shape="rect" href="error_8h.html#a46ae3737b6b20a442370723dace4b3e6" title="Handles and logs the given error code." alt="" coords="751,105,855,132"/>
<area shape="rect" href="gcode_8c.html#ad752fe57ef57309b894a1e29b1be17f6" title="Generates G&#45;code commands based on the provided text using the given font data." alt="" coords="185,181,312,208"/>
<area shape="rect" href="robot_8c.html#a027fcf39d775ebede070e699b2b43828" title="Moves the robot to its home position." alt="" coords="199,333,298,360"/>
<area shape="rect" href="cursor_8c.html#ac9206024f47e097a8c24cd2cdfa7234f" title="Constructs and initializes a new cursor_t object." alt="" coords="360,181,497,208"/>
<area shape="rect" href="robot_8c.html#aad90fa0e55a1c01b398f24b6b5285e8d" title="Sends a stroke command to the robot based on the current cursor position." alt="" coords="383,358,474,385"/>
<area shape="rect" href="cursor_8c.html#a28f88c371fa702d0ff93c682e2686cf7" title="Moves the cursor to the start of the current line (carriage return)." alt="" coords="557,54,679,81"/>
<area shape="rect" href="cursor_8c.html#abae14e94f199f0a08c0d21080564e52e" title="Moves the cursor by a specified delta." alt="" coords="585,257,651,284"/>
<area shape="rect" href="cursor_8c.html#a512b5b1efe20e69fcbfc7525ba3b2dc0" title="Moves the cursor to a new line." alt="" coords="578,105,658,132"/>
<area shape="rect" href="cursor_8c.html#acbd74b57e2f2b6852d13f61c905d82fc" title="Sets the cursor to a specified position." alt="" coords="593,206,643,233"/>
<area shape="rect" href="cursor_8c.html#a7a85519c0c8c138cb884fdac97049cd0" title="Checks if the given word would overflow the current cursor boundaries." alt="" coords="545,308,691,334"/>
<area shape="rect" href="cursor_8c.html#ae6cd8baec7e9a446d286b99ba00781c4" title="Updates the cursor position after advancing by one character." alt="" coords="581,156,655,182"/>
<area shape="rect" href="cursor_8c.html#afe2261ec63130405e2211af6c13accec" title="Checks if the current cursor position is within defined boundaries." alt="" coords="739,238,867,265"/>
<area shape="rect" href="coord_8h.html#a5bc8e590b6856be3e274cde788d2428a" title="Adds two 2D coordinates." alt="" coords="751,314,854,341"/>
<area shape="rect" href="robot_8c.html#a7491b87f64cad2b3f2e418e256ab78f0" title="Sends a command buffer to the robot and waits for a reply." alt="" coords="554,409,682,436"/>
<area shape="rect" href="serial_8c.html#a81685016bdf8b33327c0effc3946c23f" title=" " alt="" coords="757,377,848,404"/>
<area shape="rect" href="serial_8c.html#a41ebffe26e5aa854de06af059212be92" title=" " alt="" coords="749,428,857,454"/>
<area shape="rect" href="rs232_8c.html#a179396991e5d9e3ef1be67e6f03038a6" title=" " alt="" coords="937,377,1043,404"/>
<area shape="rect" href="rs232_8c.html#ad8d4dbe7691e53e178360403228d650b" title=" " alt="" coords="1113,377,1245,404"/>
<area shape="rect" href="rs232_8c.html#af66e3a0fc5eb7defb43aa61487a0b895" title=" " alt="" coords="915,428,1065,454"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gcode_8h_a44ba85fdeef6e4fb50e27ec96de1f736_icgraph.png" border="0" usemap="#agcode_8h_a44ba85fdeef6e4fb50e27ec96de1f736_icgraph" alt=""/></div>
<map name="agcode_8h_a44ba85fdeef6e4fb50e27ec96de1f736_icgraph" id="agcode_8h_a44ba85fdeef6e4fb50e27ec96de1f736_icgraph">
<area shape="rect" title="Processes a text file using the provided font data." alt="" coords="108,5,240,32"/>
<area shape="rect" href="main_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
